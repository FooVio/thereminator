{"version":3,"sources":["webpack:///webpack/bootstrap fbf4d39973edc845ba8f?58ac*","webpack:///./src/js/instruments/synth.js","webpack:///./src/js/camClient.js?dece*","webpack:///./src/js/clients.js?2185*"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wCAAuC,eAAe;;AAEtD;AACA;AACA,EAAC;;;;;;;AChBD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,SAAQ,mBAAmB;AAC3B,SAAQ;AACR;;AAEA,yBAAwB,eAAe;;AAEvC;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA,EAAC;;;;;;;AC/GD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC","file":"synth.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap fbf4d39973edc845ba8f\n **/","(function() {\n  var sendEvents = require('../camClient.js');\n  var clients = require('../clients.js');\n\n  window.onload = function() {\n    window.currentInstrument = clients.synth;\n\n    var video = document.getElementById('video');\n    var canvas = document.getElementById('canvas');\n    var context = canvas.getContext('2d');\n\n    var tracker = new tracking.ColorTracker(Object.keys(tracking.ColorTracker.knownColors_));\n    tracking.track('#video', tracker, { camera: true });\n\n    tracker.on('track', sendEvents);\n  };\n}());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/instruments/synth.js\n ** module id = 0\n ** module chunks = 2\n **/","(function() {\n  var MIN_VOLUME = 0;\n  var MAX_VOLUME = 1;\n\n  var PENTATONIC_SCALE = [183.54, 231.246, 275.0, 367.08, 462.494, 617.354, 734.162];\n  var MIN_FREQ = 0;\n  var MAX_FREQ = PENTATONIC_SCALE.length - 1;\n\n  var lastTime = 0;\n  var MAXDELTA = 500;\n\n  var dimensions = {\n    x: { min: 0, max: 450 },\n    y: { min: 0, max: 600 }\n  };\n\n  var DEFAULT_CONFIG = { parameters: {} };\n\n  var mutedInstruments = [];\n\n  var socket = io();\n\n  function map(n, start1, stop1, start2, stop2) {\n    return ((n-start1)/(stop1-start1))*(stop2-start2)+start2;\n  }\n\n  function signal(events) {\n    var currentTime = new Date().getTime();\n    var delta = currentTime - lastTime;\n\n    if (delta > MAXDELTA) {\n      var filteredEvents = removedAlreadyMutedInstruments(events);\n\n      if(filteredEvents.length !== 0) {\n        lastTime = currentTime;\n\n        console.log('event sent:', 'client-message', JSON.stringify(filteredEvents));\n        socket.emit('client-message', filteredEvents);\n      }\n    }\n  }\n\n  function getValueForParameter(parameter, range, value) {\n    if (parameter === 'freq') {\n      var freqIndex = Math.round(map(value, range.min, range.max, MAX_FREQ, MIN_FREQ));\n      return PENTATONIC_SCALE[freqIndex];\n    } else if (parameter === 'amp') {\n      return map(value, range.min, range.max, MAX_VOLUME, MIN_VOLUME)\n    } else {\n      return 0;\n    }\n  }\n\n  function createEventsFromCard(card) {\n    var config = window.currentInstrument[card.color] || DEFAULT_CONFIG;\n\n    return Object.keys(config.parameters).map(function(axis) {\n      return {\n        instrument: config.instrument,\n        parameter: config.parameters[axis],\n        value: getValueForParameter(config.parameters[axis], dimensions[axis], card[axis])\n      };\n    });\n  }\n\n  function removedAlreadyMutedInstruments(events) {\n    var newMutedInstruments = [];\n    var filteredEvents = events.filter(function(event) {\n      if ( event.parameter === 'amp' && event.value === 0) {\n        newMutedInstruments.push(event.instrument);\n        return (mutedInstruments.indexOf(event.instrument) < 0) ? true : false;\n      } else {\n        return true;\n      }\n    });\n\n    mutedInstruments = newMutedInstruments;\n\n    return filteredEvents;\n  }\n\n  function getEventsForMissingCards(availableCards) {\n    var supportedColors = Object.keys(window.currentInstrument);\n    var availableColors = availableCards.map(function(card) {\n      return card.color;\n    });\n\n    var missingColors = supportedColors.filter(function(color) {\n      return availableColors.indexOf(color) < 0;\n    });\n\n    return missingColors.map(function(color) {\n      return {\n        instrument: window.currentInstrument[color].instrument,\n        parameter: 'amp',\n        value: MIN_VOLUME\n      };\n    });\n  }\n\n  function sendEvents(e) {\n    var availableCards = e.data;\n    var eventsFromCam = availableCards.reduce(function(memo, card) {\n      return memo.concat(createEventsFromCard(card));\n    }, []);\n\n    var missingEvents = getEventsForMissingCards(availableCards);\n    signal(missingEvents.concat(eventsFromCam));\n  }\n\n  module.exports = sendEvents;\n}());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/camClient.js\n ** module id = 1\n ** module chunks = 0 1 2\n **/","(function(){\n  module.exports = {\n    drum: {\n      yellow: {\n        instrument: 'drums/kick',\n        parameters: {\n          y: 'amp'\n        }\n      },\n      cyan: {\n        instrument: 'drums/snare',\n        parameters: {\n          y: 'amp'\n        }\n      }\n    },\n    bass: {\n      cyan: {\n        instrument: 'bass',\n        parameters: {\n          y: 'amp'\n        }\n      }\n    },\n    synth: {\n      cyan: {\n        instrument: 'synth',\n        parameters: {\n          y: 'amp'\n        }\n      }\n    }\n  };\n}());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/clients.js\n ** module id = 2\n ** module chunks = 0 1 2\n **/"],"sourceRoot":""}